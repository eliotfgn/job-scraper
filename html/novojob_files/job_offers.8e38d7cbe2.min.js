!function(t,$,e){var a,p,n,r,i,l,jQuery=$,o=!1,m=Elib.parseQuery(),v=m.limit,g=m.start,y=!1,b=!1,s=window.History,c=null,q=[],d={mouseWheelSpeed:50},u={},f={},h=".searchForm:first",w=".query-field",k=".result-content",C=".pagination .ul",x=".user-message",S=".selected-tags",D=".scrollable:not(.jspScrollable)",P=".filter-pan",N="script[type*=x-emp]",j=!1,A="show-filters",U=!1,E="[data-search-result]";function O(){$(D).jScrollPane(d)}function I(t){t.preventDefault(),_()}function V(){S.empty(),f={},k.find(P+" [aria-checked=true]").each(function(){var t=$(this).text();!function(t,e){var a=$(u.tag({value:t,label:e}));if(void 0!==f[t])return;(f[t]=a).data("value",t),S.append(a)}($(this).val(),t)})}function Q(t){$("#show-filters").hasClass("show-more")||$("#show-filters").click(),"string"==typeof t?(E.html(t),Elib.lookupWidgets(),O(),r=E.clone().children()):k.empty().append(t.clone()),V(),$(P+" .filter-gr").each(function(){$(this).data("collapsed")&&$(this).find(".filter-gr-content").hide()})}function R(){var t={},e={},a={},r={},n={},i=[],l=localStorage.getItem("lastOrder"),o=localStorage.getItem("lastOrderGroup"),s=$("[data-tab-filter][data-active]"),c=!0!==s.data("resetFilters"),d=s.data("resetOrder"),u=$("[data-dropdown-filter][data-active]"),f=$(".nav-tabs[role=group][data-name]").attr("data-name"),h=$(".ordering-actions[role=group][data-name]").attr("data-name");return p.find("[name]").each(function(){var t=this.value;t&&(r[this.getAttribute("name")]=t)}),delete r.q_value,n.inputs=r,f&&(e.queryName=f,e.value=s.attr("data-value"),y&&(e.subValue=u.attr("data-value"))),d||(h?(t.queryName=h,localStorage.setItem("lastOrderGroup",h),t.value=$("[data-ordering-field][data-active]").attr("data-value"),b&&localStorage.setItem("lastOrder",t.value)):l&&(t.value=l,t.queryName=o)),c&&k.find(P+" [role=sub-group]").each(function(){var t=$(this),e=t.attr("data-group-name");t.attr("data-filter")&&$(this).val(t.attr("data-filter")),t.each(function(){var t=$(this).attr("data-filter");a[e]=a[e]||[],t&&a[e].push(t)})}),$(P+" .filter-gr").each(function(){var t=$(this).data("name"),e=$(this).data("collapsed");t&&!e&&i.push($(this).data("name"))}),i.length&&(n.collapsed=i.join(",")),q.length&&(n.expanded=q.join(",")),n.filters=a,n.order=t,n.currentPanel=e,n.limit=v,n.start=g,n.inputs=r,n.queryData=function(t){var e,a,r=Elib.clone(t.inputs)||{};for(a in t.filters)t.filters.hasOwnProperty(a)&&(r[a]=r[a]||[],r[a]=r[a].concat(t.filters[a]));return t.order.value&&(r[t.order.queryName]=r[t.order.queryName]||[],r[t.order.queryName]=r[t.order.queryName].concat(t.order.value.split(","))),(e=t.currentPanel.subValue||t.currentPanel.value||"")&&(r[t.currentPanel.queryName]=r[t.currentPanel.queryName]||[],r[t.currentPanel.queryName]=r[t.currentPanel.queryName].concat(e.split(","))),t.collapsed&&t.collapsed.length&&(r.collapsed=t.collapsed),t.expanded&&t.expanded.length&&(r.expanded=t.expanded),t.limit&&(r.limit=t.limit),t.start&&(r.start=t.start),Elib.applyIf(r,m),r}(n),n.queryUrl=window.location.pathname+T(n.queryData),n}function T(t){var e="";return"object"==typeof t&&(e="?"+$.param(t),e=decodeURIComponent(e)),e}function F(t,e){var r=RSVP.defer(),a=r.promise;return p.overlay(),$.ajax({dataType:"json",method:n,url:t,data:e}).then(function(t){!function(t){var e=location.pathname.split("/");if(!(!l||e.length<=3||U))return location.href=e.slice(0,3).join("/")+T(t);U=!1}(e),p.overlay(),t.success?r.resolve(t.data):r.reject(t.error||"Unknown Server Error")},function(t,e,a){p.overlay(),r.reject(a.message)}),a}function G(t){t.preventDefault();var e=$(this);e.attr("aria-checked");e.attr("data-filter",e.val()),e.val()?e.attr("aria-checked",!0):e.attr("aria-checked",!1),_()}function z(t){t.preventDefault();var e=$(this).parent().data("value"),a=k.find(P+" [data-filter="+e+"]");a.attr("aria-checked",!1),a.attr("data-filter",""),_()}function W(t){t.hasOwnProperty("t")||(t.t=e),function(t,e,a,r,n){var i;e=void 0!==e?e:0,a=void 0!==a?a:"",Q(t),j&&(i=k.offset())&&$("html, body").animate({scrollTop:i.top-110},500);var l=$("[data-meta-search]").length?$("[data-meta-search]"):null,o=$("[data-meta-total]").length?$("[data-meta-total]"):null,s=$("[data-meta-search-title]").length?$("[data-meta-search-title]"):null;o&&o.html("<strong>"+e+"</strong>"),s.html(n),o.addClass("text-large"),l?(l.html(a),l.append(r)):$("h3 span").each(function(){"color-b"===$(this).attr("class")?$(this).find("strong").html(e):($(this).html(a),$(this).append(r))})}(t.content,t.total,t.q,t.suggestion,t.t),b=y=!1}function _(){return g=null,H.apply(this,arguments)}function H(e,t){return p=$(h),t=null!=t?t:!e,(e=e||R()).url=e.url||a,i=c,c=e,o=!1,t&&!function(t){return"pushState"in s?(s.pushState(t,null,t.queryUrl),!0):(window.location.search=t.queryUrl,!1)}(e)&&RSVP.Promise.resolve(),$(".search-btn").addClass("hide"),F(e.url,e.queryData).then(function(t){return W(t),{response:t,state:e}},function(t){!function(t){var e="";$.makeArray(t).forEach(function(t){e=e+"<p>"+t+"</p>"}),$(x).html(u.message({type:"error",messages:e}))}(t),"pushState"in s?(c=i,Q(r),s.back()):window.location.search=i.queryUrl})}delete m.limit,delete m.start,delete m.t,delete m.q,delete m.q_value,Elib.ready(function(){O(),localStorage.removeItem("lastOrder"),localStorage.removeItem("lastOrderGroup"),window.$=jQuery,s.options.debug=!0,s.init(),s.Adapter.bind(window,"statechange",function(){var t=s.getState(),e=t.data;if(e)return o||e.queryUrl===c.queryUrl?void 0:_(e,!1);window.location=t.url}),p=$(h),w=$(w),k=$(k),E=$(E),r=k.clone().children(),C=$(C),S=$(S),A=$(A),l=$('meta[property="page:path"]').attr("content")||null,N=$(N).each(function(){var t=$(this),e=t.text();e=e.replace(/^\s+/,""),u[t.data("templateName")]=Elib.compile(e,{})}),a=$("[data-api-url]").attr("data-api-url")||p.attr("action"),n="string"==typeof(n=p.attr("method"))&&n.toUpperCase(),$(P+" .filter-gr").each(function(){$(this).data("collapsed")&&$(this).find(".filter-gr-content").hide()}),S.on("click",".e-tag i",z),$("body").on("submit",h,I),$("body").on("click",".query-field .fa-search",function(t){if($("[name=q]").val()!==c.inputs.q)return I(t);t.preventDefault()}),$("body").on("click",'[data-action="delete-all"]',function(t){var e=$(".filter-pan [name=q]").data("ElibTextField");t.preventDefault(),$(".filter-pan [role=menuitemcheckbox][aria-checked=true]").attr("aria-checked",!1),e&&e.reset(),_()}),$("body").on("click",".filter-actions li",function(t){if(t.preventDefault(),!$(this).hasClass("active")){var e=$(this).attr("data-dropdown-filter");$(this).parents(".filter-actions").find(".active").removeClass("active").removeAttr("data-active"),$(this).addClass("active").attr("data-active","true"),y=e?!!1:!!0,_()}}),$("body").on("click",".ordering-actions li",function(t){if(t.preventDefault(),!$(this).hasClass("active")){var e=$(this);$(this).parents(".ordering-actions").find(".active").removeClass("active").removeAttr("data-active"),e.addClass("active").attr("data-active","true"),b=!0,_()}}),k.on("change","[name=limit]",function(){v=$("[name=limit]").val(),_()}),$("body").on("change","select.filters",G),k.on("selected",P+" #checked-list",function(t,e){var a=e.id,r=e.label,n=$(this).parents("[data-name]:first").data("name").toLowerCase(),i=$(this).parents("[data-group-name]:first").data("groupName"),l=u.filterCheckbox({label:r,filter:n,value:a,groupName:i});l=$(l),$(this).parent().find(".checked-list-"+n).prepend(l),l.trigger("click")}),k.on("click",".pagination:not(.no-ajax) a",function(t){t.preventDefault();var e=$(this).attr("href")||"";g=Elib.parseQuery(e).start,U=!0,H()}),k.on("click",P+" .filter-gr-header",function(t){t.preventDefault();var e=$(this),a=e.parent(),r=a.data("collapsed");r?($(".filter-gr-content").slideUp(function(){$(this).parent().find("i.fa-minus").removeClass("fa-minus").addClass("fa-plus"),$(this).parent().data("collapsed",!0)}),a.find(".filter-gr-content").slideDown(function(){e.find("i.fa-plus").removeClass("fa-plus").addClass("fa-minus")})):a.find(".filter-gr-content").slideUp(function(){e.find("i.fa-minus").removeClass("fa-minus").addClass("fa-plus")}),a.data("collapsed",!r)}),k.on("click",P+" .filter-gr-content .display-more",function(t){var e;t.preventDefault();var a=$(this).parent(),r=a.find(".inner"),n=a.find(".display-more"),i=!r.hasClass("fixed-height"),l=r.find("ul").height(),o=a.parent().data("name");i?($("html, body").animate({scrollTop:$(this).parent().parent().offset().top},"slow"),r.animate({height:210},function(){r.addClass("fixed-height"),r.removeAttr("style"),n.text("Afficher plus")}),e=q.indexOf(o),q.splice(e,1)):(r.animate({height:l},function(){r.removeClass("fixed-height"),r.removeAttr("style"),n.text("Afficher moins")}),q.push(o))}),c=R(),V(),$("#show-filters").click(function(t){t.preventDefault(),$(".result-content").toggleClass("transform"),$(this).toggleClass("show-more"),$(this).hasClass("show-more")?$(this).html('Affichez les filtres <i class="fa spaced-left fa-angle-double-right fa-1x"></i>'):$(this).html('<i class="fa spaced-right fa-angle-double-left fa-1x"></i>Masquez les filtres')})}),window.searchApi={refresh:function(){return _().then(function(t){return j=!0,RSVP.Promise.resolve(t)})},withoutScroll:function(){return j=!1,this},reload:function(){return H().then(function(t){return j=!0,RSVP.Promise.resolve(t)})},getQueryData:function(){return"undefined"!=typeof state?state.queryData:R().queryData}}}("undefined"!=typeof exports&&exports,"undefined"!=typeof jQuery&&jQuery);